<!DOCTYPE HTML>
<html lang="en">
<head>
	<title>MAP: Mass shootings since Sandy Hook - New York Daily News</title>
	<link rel="icon" type="image/png" href="http://interactive.nydailynews.com/favicons.png">
	<!-- DEFAULT -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<link rel="apple-touch-icon" href="">
	<meta name="format-detection" content="telephone=no" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge" />

	<!-- TITLES -->
	<meta property="og:title" content='MAP: Mass shootings since Sandy Hook' />
	<meta name="twitter:title" content='MAP: Mass shootings since Sandy Hook' />

	<!-- DESCRIPTION -->
	<meta name="description" content="A map of the mass shootings in the U.S. since 2013, updated every month" />
	<meta property="og:description" content="A map of the mass shootings in the U.S. since 2013, updated every month" />
	<meta name="twitter:description" content="A map of the mass shootings in the U.S. since 2013, updated every month" />

	<!-- KEYWORD -->
	<meta name="keywords" content="Mass shootings,mass shootings map" />
	<meta name="news_keywords" content="Mass shootings,mass shootings map" />

	<!-- LINK -->
	<link rel="canonical" href="http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/">
	<meta property="og:url" content="http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/" />
	<meta name="twitter:url" content="http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/" />

	<!-- THUMBNAIL IMAGE-->
	<meta property="og:image" content="http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/img/share.jpg" />
	<meta name="twitter:image" content="http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/img/share.jpg" />
	<meta name="twitter:image:alt" content="An image of a map marked with regional counts of the number of mass shootings across the United States" />
	<meta property="og:image:width" content="1024" />
	<meta property="og:image:height" content="512" />

	<!-- PARSELY -->
	<script type="application/ld+json">
		{
			"@context": "http://schema.org",
			"@type": "NewsArticle",
			"headline": "MAP: Mass shootings since Sandy Hook",
			"url": "http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/",
			"thumbnailUrl": "http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/img/share.jpg",
			"dateCreated": "2017-10-03T16:00:00Z",
			"articleSection": "Interactive",
			"creator": ["Interactive Project","Joe Murphy"],
			"keywords": ["interactive map","interactive project","interactive","las vegas shooting","mass murder","las vegas","gun violence"]
		}
	</script>

	<!-- NO NEED TO FILL -->
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:domain" content="http://interactive.nydailynews.com"/>
	<meta name="twitter:site" content="@nydailynews">
	<meta name="twitter:creator" content="@nydni">
	<meta name="decorator" content="responsive" />
	<meta name="nydn_section" content="NY Daily News" />
	<meta name="msvalidate.01" content="02916AAC0DA8B068EFE01D721E03ED7E" />
	<meta name="p:domain_verify" content="78efe4f5c9935744af497772f68a0ee7" />
	<meta property="fb:app_id" content="107464888913" />
	<meta property="fb:admins" content="1594068001" />
	<meta property="fb:pages" content="268914272540" />
	<meta property="og:type" content="article" />
	<meta property="og:site_name" content="NY Daily News" />
	<meta property="article:publisher" content="https://www.facebook.com/NYDailyNews/" />
	<meta name="localeCountry" content="US"/>
	<meta name="localeLanguage" content="en" />

	<!-- ADOBE ANALYTICS -->
	<script src="//assets.adobedtm.com/4fc527d6fda921c80e462d11a29deae2e4cf7514/satelliteLib-c91fdc6ac624c6cbcd50250f79786de339793801.js"></script>

	<link href='https://fonts.googleapis.com/css?family=Open%20Sans|Open+Sans+Condensed:300,700|PT+Serif' rel='stylesheet' type='text/css'>
	<script data-main="//www.nydailynews.com/nydn/js/rh.js?r=20170405001" src="//www.nydailynews.com/nydn/js/require.js?r=2016LIST" defer></script>
	  
	<script>
		var nydn = nydn || {
			"section": "NYDailyNews",
			"subsection": "news",
			"template": "article",
			"revision": "201609014009",
			"bidder": { contains: function() {} },
			"targetPath": document.location.pathname
		};
		var nydnDO = [ { 
			'title':'xxxMAP: Mass shootings since Sandy Hookxxx', 
			'link':'http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/', 
			'p_type':'interactive', 
			'section':'interactive' 
		}];
	</script>
	
	<!-- ADS-START -->
	<script src="//interactive.nydailynews.com/includes/ads/ads.js" onload="nydn_ads('project');"></script>
	<!-- ADS-END -->

	<link rel="stylesheet" href="//assets.nydailynews.com/nydn/c/rh.css">
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="//interactive.nydailynews.com/js/leaflet/1.2.0/leaflet.css">
	<link rel="stylesheet" href="//interactive.nydailynews.com/js/leaflet/markercluster/1.1.0/MarkerCluster.Default.css">

	<style type="text/css">

	</style>

	<script>var nav_params = {section: 'projects', url: 'http://interactive.nydailynews.com/project/'};</script>
	<script src="//interactive.nydailynews.com/library/vendor-nav/vendor-include.js" defer></script>
	<style>
	#shooting-map {
		margin: 10px auto;
		height: 400px;
	}
	</style>
</head>
<body id="nydailynews" data-section="nydailynews" data-subsection="NY Daily News">

<!-- SITEHEADER-START -->
<header id="templateheader"></header>
<!-- SITEHEADER-END -->

<!-- CONTENT-START -->
<main>
	<article>
		<div>

<div class="intro">
	<h2>Mass Shootings</h2>
	<h1>MAP: Mass shootings in the United States since 2013</h1>
	<div>
		<ul class="ra-share" id="ra-share-top" style="text-align: center;">
			<li class="rt-share-f"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/">facebook</a> </li>
			<li class="ra-share-t"> <a target="_blank" href="https://twitter.com/intent/tweet?text=Here's a map of mass shootings in the U.S. since 2013&url=http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/&via=NYDNi&related=nydailynews,joemurph">Tweet</a></li>
			<li class="ra-share-e"> <a href="mailto:?subject=&body=http://interactive.nydailynews.com/map/mass-shootings-since-sandy-hook/">email</a> </li>
		</ul>
	</div>

	<p class="stamp">Published October 3, 2017</p>
	<p id="datestamp" class="stamp">Last updated November 6, 2017</p>

	<p>
	Since the mass shooting at Sandy Hook Elementary School in Newtown, Connecticut, more than 1,700 died in subsequent mass shootings. More than 6,000 suffered injuries. Since <a href="las-vegas-2017/">the October 2017 Las Vegas mass shooting</a>, 55 have died in mass shootings and 140 have been injured, including <a href="http://www.nydailynews.com/news/national/26-dead-gunman-opens-fire-texas-church-article-1.3613015">the 26 killed and 20 injured in the Nov. 5 mass shooting in Texas</a>. 
	</p>
	<p>
		Explore these grim incidents in this map of mass shootings in the United States.
	</p>
	<!--
	<p>
		<em>
		Looking for <a href="las-vegas-2017/">the map of mass shootings from Sandy Hook until the 2017 Las Vegas mass shooting</a>?
		</em>
	</p>
	-->

</div>

<section id="map">
    <form id="panel">
	<fieldset id="filter" style="text-align: center;">
		<legend>Filter mass shootings by:</legend>

        <!--
		<div class="select">
			<select>
				<option value="AL">Alabama</option>
				<option value="AK">Alaska</option>
				<option value="AZ">Arizona</option>
				<option value="AR">Arkansas</option>
				<option value="CA">California</option>
				<option value="CO">Colorado</option>
				<option value="CT">Connecticut</option>
				<option value="DE">Delaware</option>
				<option value="DC">District Of Columbia</option>
				<option value="FL">Florida</option>
				<option value="GA">Georgia</option>
				<option value="HI">Hawaii</option>
				<option value="ID">Idaho</option>
				<option value="IL">Illinois</option>
				<option value="IN">Indiana</option>
				<option value="IA">Iowa</option>
				<option value="KS">Kansas</option>
				<option value="KY">Kentucky</option>
				<option value="LA">Louisiana</option>
				<option value="ME">Maine</option>
				<option value="MD">Maryland</option>
				<option value="MA">Massachusetts</option>
				<option value="MI">Michigan</option>
				<option value="MN">Minnesota</option>
				<option value="MS">Mississippi</option>
				<option value="MO">Missouri</option>
				<option value="MT">Montana</option>
				<option value="NE">Nebraska</option>
				<option value="NV">Nevada</option>
				<option value="NH">New Hampshire</option>
				<option value="NJ">New Jersey</option>
				<option value="NM">New Mexico</option>
				<option value="NY">New York</option>
				<option value="NC">North Carolina</option>
				<option value="ND">North Dakota</option>
				<option value="OH">Ohio</option>
				<option value="OK">Oklahoma</option>
				<option value="OR">Oregon</option>
				<option value="PA">Pennsylvania</option>
				<option value="RI">Rhode Island</option>
				<option value="SC">South Carolina</option>
				<option value="SD">South Dakota</option>
				<option value="TN">Tennessee</option>
				<option value="TX">Texas</option>
				<option value="UT">Utah</option>
				<option value="VT">Vermont</option>
				<option value="VA">Virginia</option>
				<option value="WA">Washington</option>
				<option value="WV">West Virginia</option>
				<option value="WI">Wisconsin</option>
				<option value="WY">Wyoming</option>
			</select>
				<div class="select_arrow"></div>
		</div>
        -->

		<div>
			<ul>
				<li>
					<input type="radio" name="deaths" id="all" value="all" checked>
					<div class="check"></div>
					<label for="all">All mass shootings</label>
				</li>
				<li>
					<input type="radio" name="deaths" id="death-1" value="death-1">
					<div class="check"><div class="inside"></div></div>
					<label for="death-1">Shooting with at least one fatality</label>
				</li>
				<li>
					<input type="radio" name="deaths" id="death-3" value="death-3">
					<div class="check"><div class="inside"></div></div>
					<label for="death-3">3+ fatalities</label>
				</li>
                <li>
					<input type="radio" name="deaths" id="death-5" value="death-5">
					<div class="check"><div class="inside"></div></div>
					<label for="death-5">5+ fatalities</label>
				</li>
				<li>
					<input type="radio" name="deaths" id="death-10" value="death-10">
					<div class="check"><div class="inside"></div></div>
					<label for="death-10">10+ fatalities</label>
				</li>
			</ul>
		</div>
	</fieldset>
	</form>
	<div id="shooting-map"></div>
</section>

<section id="shootings">
	<p class="latest-news">
		<a href="http://www.nydailynews.com/tags/mass-murder">THE LATEST</a>: 
		<strong id="latest-news-headline"></strong>
	</p>

	<script>
		var s = document.createElement('script');
		var rando = function() { 
			var text = "";
			var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

			for( var i=0; i < 5; i++ )
				text += possible.charAt(Math.floor(Math.random() * possible.length));
			return text;
		}
		s.onload = function() { callback(); }
		s.setAttribute('src', '//interactive.nydailynews.com/project/las-vegas-victims/tag-mass-murder-1.js?' + rando());
		document.getElementsByTagName('head')[0].appendChild(s);
		function callback() {
			document.getElementById('latest-news-headline').innerHTML = hed;
		}
	</script>

	<p class="caption">Data from <a href="http://www.gunviolencearchive.org">Gun Violence Archive</a></p>
	<p class="stamp">Last updated November 6, 2017</p>
</section>

  <div class="ad center">
	<div id='div-gpt-ad-1423507761396-2'>
	  <script>
		googletag.cmd.push(function() { googletag.display('div-gpt-ad-1423507761396-2'); });
	  </script>
	</div>
  </div>

<div>
	<p class="caption">Interactive by Joe Murphy</p>
</div>

		</div>
	</article>
</main>

<script src="//interactive.nydailynews.com/js/jquery.min.js"></script>
<script src="//interactive.nydailynews.com/js/leaflet/1.2.0/leaflet.js"></script>
<script src="//interactive.nydailynews.com/js/leaflet/markercluster/1.1.0/leaflet.markercluster.js"></script>
<script>
var center_point = [39.5,-98.35];
var m = {
    config: {
        dev: document.location.hash === '#dev' ? 1 : 0,
    },
    map: L.map('shooting-map', { minZoom: 4, maxZoom: 9, zoomControl:true, scrollWheelZoom:false }).setView(center_point, 4),
    markers: [],
    tile: 'https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png',
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
    current_layer: 'all',
    marker_group: { 'all': [] },
    layer_group: {},
    slugify: function(text) {
        return text
            .toLowerCase()
            .replace(/[^\w ]+/g,'')
            .replace(/ +/g,'-');
    },
    month_lookup: {
        'Jan': 'January',
        'Feb': 'February',
        'Mar': 'March',
        'Apr': 'April',
        'May': 'May',
        'Jun': 'June',
        'Jul': 'July',
        'Aug': 'August',
        'Sep': 'September',
        'Oct': 'October',
        'Nov': 'November',
        'Dec': 'December'
    },
    convert_date: function(text) {
        // Turn a string such as 1-Oct-17 into an AP-style'd date.
        var bits = text.split('-');
        var year = '20' + bits[2];
        var month = this.month_lookup[bits[1]];
        return month + ' ' + bits[0] + ', ' + year;

    },
    remove_markers: function(slug) {
        this.map.removeLayer(this.layer_group[slug]);
    },
    load_markers: function(slug) {
        // Given a slug that corresponds to a marker_group of markes, loop through them and add them to the map.

        this.layer_group[slug] = L.layerGroup().addTo(this.map);
        var len = this.marker_group[slug].length;
        for ( var i = 0; i < len; i ++ )
        {
            this.clustergroup.addLayer(this.marker_group[slug][i]);
        }
    },
    add_to_marker_group: function(slug, marker)
    {
        // The final stop in the marker assignation.
        if ( typeof this.marker_group[slug] === 'undefined' ) this.marker_group[slug] = [];
        this.marker_group[slug].push(marker);
    },
    add_marker: function(lat, lon, id, loc, injured, killed, date_raw)
    {
        // Build out a marker, assign it to the appropriate marker_group(s).
        var marker = L.marker(new L.LatLng(lat, lon))//.addTo(this.marker_groups[]);
        var date_str = this.convert_date(date_raw);
        //var content = "<h3><a href='#" + id + "'>" + loc + "</a></h3><p>" + desc + "</p>";
        var content = "<h3>" + loc + "</h3><p>" + date_str + ': ' + injured + " injured, " + killed + " killed.</p>";
        marker.bindPopup(content);
        //this.markers.addLayer(marker);
        //this.markers.push(marker);

        // figure out which layer(s) to add the marker to.
        var killed_bucket = killed;
        if ( killed >= 10 ) killed_bucket = 10;
        while ( killed_bucket > 0 ) {
            if ( killed_bucket === 4 ) killed_bucket = 3;
            else if ( killed_bucket > 5 && killed_bucket < 10 ) killed_bucket = 5;
            this.add_to_marker_group('death-' + killed_bucket, marker);
            killed_bucket -= 1;
        }
        this.add_to_marker_group('all', marker);
    },
    process_marker: function(d) {
        // Intermediary function between the data ingestion and the function that hands the markers to the marker_group.
        if ( d['lat'] !== '' ) {
            var slug = m.slugify(d['Incident Date'] + '-' + d['City Or County'] + '-' + d['State']);
            var loc = d['City Or County'] + ', ' + d['State'];
            this.add_marker(d['lat'], d['long'], slug, loc, d['injured'], d['killed'], d['Incident Date']);
        }
    },
    init: function()
    {
        this.clustergroup = L.markerClusterGroup();
        L.tileLayer(this.tile, {
            attribution: this.attribution,
            maxZoom: 16
        }).addTo(this.map);
        this.marker_group = L.layerGroup().addTo(this.map);
        // An item looks like this:
        /*
          {
            "Incident Date": "1-Oct-17",
            "Address": "1000 block of Massachusetts St",
            "City Or County": "Lawrence",
            "State": "Kansas",
            "killed": 3,
            "injured": 2,
            "lat": 38.965463,
            "long": -95.235711
          },
        */
        $.getJSON('data/201710.json', function(data) {
            var len = data.length;
            for ( var i = 0; i < len; i ++ ) {
                m.process_marker(data[i]);
            }
            panel.init();
        });
        $.getJSON('data/201711.json', function(data) {
            var len = data.length;
            for ( var i = 0; i < len; i ++ ) {
                m.process_marker(data[i]);
            }
        });
        this.map.addLayer(this.clustergroup);

        //this.map.fitBounds(this.marker_group);
        //this.map.addLayer(this.markers);
    }
}


var panel = {
		hash: document.location.hash,
		hash_parts: [],
		description: document.getElementById('current'),
		taxonomy: {
			'_blank': {
				count: 0,
				name: ''
			},
		},
		active: [], // List of the active slugs. If no slugs are specified all start off active.
		length: 0,
		all: function(action)
		{
			// action is either clear or show
			// loop through all the checkboxes and clear / show.
		},
		toggle_url: function(value)
		{
			// Update the url to reflect the markers on the map.
			// We do this so we can permalink particular maps.
			if ( this.hash_parts.indexOf(value) === -1 )
			{
				// Append to the hash and description
				this.hash_parts.push(value);
				if ( this.hash === '' )
				{
					this.hash = value;
					//this.description.innerHTML = this.taxonomy[value]['name'];
					//this.hed.innerHTML = this.taxonomy[value]['name'];
				}
				else
				{
					this.hash += ',' + value;
					//this.description.innerHTML += ', ' + this.taxonomy[value]['name'];
					//this.hed.innerHTML += ', ' + this.taxonomy[value]['name'];
				}
			}
			else
			{
				// Remove from the hash and description
				var index = this.hash_parts.indexOf(value);
				this.hash_parts.splice(index, 1);
				var len = this.hash_parts.length;
				if ( len > 0 )
				{
					this.hash = this.hash_parts[0];
					//this.description.innerHTML = this.taxonomy[this.hash_parts[0]]['name'];
					//this.hed.innerHTML = this.taxonomy[this.hash_parts[0]]['name'];
					for ( var i = 1; i < len; i ++ )
					{
						this.hash += ',' + this.hash_parts[i];
						//this.description.innerHTML += ', ' + this.taxonomy[this.hash_parts[i]]['name'];
						//this.hed.innerHTML += ', ' + this.taxonomy[this.hash_parts[i]]['name'];
					}
				}
				else
				{
					this.hash = '';
					//this.description.innerHTML = '';
					//this.hed.innerHTML = '';
				}
			}
			window.history.replaceState('', '', window.location.origin + window.location.pathname + '#' + this.hash);
		},
		show_report_items: function(value)
		{
			// Show the crime reports in the #all column that we're mapping on the map
			$('#all .' + value).removeClass('hide');
			// Get the class in the item that has the date so we can make sure to show the date header.
			var date_class = $('#all .' + value)[0].classlist[$('#all .' + value)[0].classlist.length - 1];
			$('h3#' + date_class).removeClass('hide');
		},
		remove_report_items: function(value)
		{
			// Remove crime reports in the #all column that we're mapping on the map
			$('#all .' + value).addClass('hide');
			// Get the class in the item that has the date so we can make sure to show the date header.
			var date_class = $('#all .' + value)[0].classlist[$('#all .' + value)[0].classlist.length - 1];
			$('h3#' + date_class).addClass('hide');
			// Before we hide the header, we make sure that header isn't servicing other crimes that are still visible.
			var items = $('#all li.' + date_class);
		},
		action: function(checked, value) 
		{ 
			if ( checked ) 
			{
				m.clustergroup.remove();
				m.clustergroup = L.markerClusterGroup();
				m.load_markers(value);
				m.map.addLayer(m.clustergroup);

				this.toggle_url(value);
				//this.show_report_items(value);
			}
			else
			{
				//m.remove_markers(value);
				//this.toggle_url(value);
			}
		},
		build_interface: function()
		{
			// Write the list of checkboxes we use for interacting with the map
			var k = Object.keys(this.taxonomy);
			var len = k.length;
			k.sort();
			for ( var i = 0; i < len; i++ )
			{
				var key = k[i];
				var t = this.taxonomy[key];
				var markup = '<li><label for="' + key + '">\n\
<input type="checkbox" onClick="recent.action(this.checked, this.value)" value="' + key + '" id="' + key + '">\n\
' + t['name'] + ' <span>(' + t['count'] + ')</span></label></li>';
                document.getElementById('interface').innerHTML += markup;
            }
        },
        init: function ()
        {
            //this.length 
            this.hed = document.getElementById('current');
            //this.build_interface();

            // If we've got hash values on page load that means we load only certain crimes.
            if ( this.hash !== '' && this.hash !== '#dev' )
            {
                var hs = this.hash.substring(1);
                var items = [hs];
                if ( hs.indexOf(',') > 0 )
                {
                    items = hs.split(',')
                }
                this.hash_parts = items;
                var len = items.length;
                for ( var i = 0; i < len; i++ )
                {
                    // Activate these, hide all the others.
                    m.load_markers(data[items[i]], items[i]);
                    $('#' + items[i]).prop('checked', true);
                }
            }
            else
            {
                this.hash = 'all';
                this.hash_parts = ['all'];
                m.load_markers('all');
                //m.map.addLayer(m.clustergroup);
            }

            // Add event handler to the radio buttons.
            var radios = document.forms['panel'].elements['deaths'];
            var l = radios.length;
			for ( var i = 0; i < l; i ++ ) {
                radios[i].onclick = function() { 
                    if ( m.config.dev === 1 ) console.log("Radio clicked: ", this.value);
					panel.action(this.checked, this.value);
                };
			}
                                                                                             
        }
};
m.init();
</script>
<!-- CONTENT-END -->

<!-- FOOTER-START -->
<footer id="templatefooter"></footer>
<!-- FOOTER-END -->
<div id="ra-bp">
	  </div> <section id="rao">  <div id="rao-close"></div> <div id="rao-wrap"></div> </section>
</div>
<div id="r-scripts">
	<div id="parsely-root" style="display: none">
		<span id="parsely-cfg" data-parsely-site="nydailynews.com"></span>
	</div>
	<div class="r-ad">
		<div id="div-gpt-ad-x100">
		</div>
	</div>
</div>
</body>
</html>
